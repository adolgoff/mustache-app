/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
(function(a,b){if(typeof exports==="object"&&exports){module.exports=b;}else{if(typeof define==="function"&&define.amd){define(b);}else{a.Mustache=b;}}}(this,(function(){var e=/\s*/;var l=/\s+/;var i=/\S/;var h=/\s*=/;var n=/\s*\}/;var t=/#|\^|\/|>|\{|&|=|!/;var j=RegExp.prototype.test;var v=Object.prototype.toString;function o(z,y){return j.call(z,y);}function g(y){return !o(i,y);}var k=Array.isArray||function(y){return v.call(y)==="[object Array]";};function f(y){return y.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");}var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function m(y){return String(y).replace(/[&<>"'\/]/g,function(z){return d[z];});}function u(y){this.string=y;this.tail=y;this.pos=0;}u.prototype.eos=function(){return this.tail==="";};u.prototype.scan=function(z){var y=this.tail.match(z);if(y&&y.index===0){this.tail=this.tail.substring(y[0].length);this.pos+=y[0].length;return y[0];}return"";};u.prototype.scanUntil=function(z){var y,A=this.tail.search(z);switch(A){case -1:y=this.tail;this.pos+=this.tail.length;this.tail="";break;case 0:y="";break;default:y=this.tail.substring(0,A);this.tail=this.tail.substring(A);this.pos+=A;}return y;};function s(y,z){this.view=y||{};this.parent=z;this._cache={};}s.make=function(y){return(y instanceof s)?y:new s(y);};s.prototype.push=function(y){return new s(y,this);};s.prototype.lookup=function(y){var B=this._cache[y];if(!B){if(y=="."){B=this.view;}else{var A=this;while(A){if(y.indexOf(".")>0){B=A.view;var C=y.split("."),z=0;while(B&&z<C.length){B=B[C[z++]];}}else{B=A.view[y];}if(B!=null){break;}A=A.parent;}}this._cache[y]=B;}if(typeof B==="function"){B=B.call(this.view);}return B;};function q(){this.clearCache();}q.prototype.clearCache=function(){this._cache={};this._partialCache={};};q.prototype.compile=function(A,y){var z=this._cache[A];if(!z){var B=a.parse(A,y);z=this._cache[A]=this.compileTokens(B,A);}return z;};q.prototype.compilePartial=function(z,B,y){var A=this.compile(B,y);this._partialCache[z]=A;return A;};q.prototype.getPartial=function(y){if(!(y in this._partialCache)&&this._loadPartial){this.compilePartial(y,this._loadPartial(y));}return this._partialCache[y];};q.prototype.compileTokens=function(A,z){var y=this;return function(B,D){if(D){if(typeof D==="function"){y._loadPartial=D;}else{for(var C in D){y.compilePartial(C,D[C]);}}}return p(A,y,s.make(B),z);};};q.prototype.render=function(A,y,z){return this.compile(A)(y,z);};function p(F,z,y,I){var C="";var A,G,H;for(var D=0,E=F.length;D<E;++D){A=F[D];G=A[1];switch(A[0]){case"#":H=y.lookup(G);if(typeof H==="object"){if(k(H)){for(var B=0,K=H.length;B<K;++B){C+=p(A[4],z,y.push(H[B]),I);}}else{if(H){C+=p(A[4],z,y.push(H),I);}}}else{if(typeof H==="function"){var J=I==null?null:I.slice(A[3],A[5]);H=H.call(y.view,J,function(L){return z.render(L,y);});if(H!=null){C+=H;}}else{if(H){C+=p(A[4],z,y,I);}}}break;case"^":H=y.lookup(G);if(!H||(k(H)&&H.length===0)){C+=p(A[4],z,y,I);}break;case">":H=z.getPartial(G);if(typeof H==="function"){C+=H(y);}break;case"&":H=y.lookup(G);if(H!=null){C+=H;}break;case"name":H=y.lookup(G);if(H!=null){C+=a.escape(H);}break;case"text":C+=G;break;}}return C;}function x(E){var z=[];var D=z;var F=[];var B;for(var A=0,y=E.length;A<y;++A){B=E[A];switch(B[0]){case"#":case"^":F.push(B);D.push(B);D=B[4]=[];break;case"/":var C=F.pop();C[5]=B[2];D=F.length>0?F[F.length-1][4]:z;break;default:D.push(B);}}return z;}function b(D){var A=[];var C,z;for(var B=0,y=D.length;B<y;++B){C=D[B];if(C){if(C[0]==="text"&&z&&z[0]==="text"){z[1]+=C[1];z[3]=C[3];}else{z=C;A.push(C);}}}return A;}function r(y){return[new RegExp(f(y[0])+"\\s*"),new RegExp("\\s*"+f(y[1]))];}function w(O,E){O=O||"";E=E||a.tags;if(typeof E==="string"){E=E.split(l);}if(E.length!==2){throw new Error("Invalid tags: "+E.join(", "));}var I=r(E);var A=new u(O);var G=[];var F=[];var D=[];var P=false;var N=false;function M(){if(P&&!N){while(D.length){delete F[D.pop()];}}else{D=[];}P=false;N=false;}var B,z,H,J,C;while(!A.eos()){B=A.pos;H=A.scanUntil(I[0]);if(H){for(var K=0,L=H.length;K<L;++K){J=H.charAt(K);if(g(J)){D.push(F.length);}else{N=true;}F.push(["text",J,B,B+1]);B+=1;if(J=="\n"){M();}}}if(!A.scan(I[0])){break;}P=true;z=A.scan(t)||"name";A.scan(e);if(z==="="){H=A.scanUntil(h);A.scan(h);A.scanUntil(I[1]);}else{if(z==="{"){H=A.scanUntil(new RegExp("\\s*"+f("}"+E[1])));A.scan(n);A.scanUntil(I[1]);z="&";}else{H=A.scanUntil(I[1]);}}if(!A.scan(I[1])){throw new Error("Unclosed tag at "+A.pos);}C=[z,H,B,A.pos];F.push(C);if(z==="#"||z==="^"){G.push(C);}else{if(z==="/"){if(G.length===0){throw new Error('Unopened section "'+H+'" at '+B);}var y=G.pop();if(y[1]!==H){throw new Error('Unclosed section "'+y[1]+'" at '+B);}}else{if(z==="name"||z==="{"||z==="&"){N=true;}else{if(z==="="){E=H.split(l);if(E.length!==2){throw new Error("Invalid tags at "+B+": "+E.join(", "));}I=r(E);}}}}}var y=G.pop();if(y){throw new Error('Unclosed section "'+y[1]+'" at '+A.pos);}F=b(F);return x(F);}var a={};a.name="mustache.js";a.version="0.7.2";a.tags=["{{","}}"];a.Scanner=u;a.Context=s;a.Writer=q;a.parse=w;a.escape=m;var c=new q();a.clearCache=function(){return c.clearCache();};a.compile=function(z,y){return c.compile(z,y);};a.compilePartial=function(z,A,y){return c.compilePartial(z,A,y);};a.compileTokens=function(z,y){return c.compileTokens(z,y);};a.render=function(A,y,z){return c.render(A,y,z);};a.to_html=function(B,z,A,C){var y=a.render(B,z,A);if(typeof C==="function"){C(y);}else{return y;}};return a;}())));